from scapy.all import *
a = IP(dst="10.10.42.98")
b = ICMP()
pkt = sr1((a/b)/"hello")
print(pkt.summary())

# Notes :
# Run as Root from pycharm in linux
# Packets generate software with ICMP packets
# The sr() function is for sending packets and receiving answers, which returns a couple of packets with answers,
# and also the unanswered packets which can be displayed as shown above.The function sr1() is a variant that only
# returns on packet that answered the packet that was sent.
#How to test
# Use 2 different VMs or use THM machine deployed and send ICMP packet, Cross check with WireShark packet Analyzer.
# sendp(pkt,count=2)
# https://scapy.readthedocs.io/en/latest/usage.html
# https://github.com/skm-python/scapy
